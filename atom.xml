<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <author>
    <name>John Doe</name>
  </author>
  <generator uri="https://hexo.io/">Hexo</generator>
  <id>https://imouyo.github.io/</id>
  <link href="https://imouyo.github.io/" rel="alternate"/>
  <link href="https://imouyo.github.io/atom.xml" rel="self"/>
  <rights>All rights reserved 2026, John Doe</rights>
  <title>Hexo</title>
  <updated>2026-02-13T13:11:45.715Z</updated>
  <entry>
    <author>
      <name>John Doe</name>
    </author>
    <content>
      <![CDATA[<p><img src="Hexo%E7%9A%84%E6%B5%8B%E8%AF%95/avatar.gif" alt="avatar" /></p>]]>
    </content>
    <id>https://imouyo.github.io/2026/02/13/Hexo%E7%9A%84%E6%B5%8B%E8%AF%95/</id>
    <link href="https://imouyo.github.io/2026/02/13/Hexo%E7%9A%84%E6%B5%8B%E8%AF%95/"/>
    <published>2026-02-13T13:11:22.000Z</published>
    <summary>
      <![CDATA[<p><img src="Hexo%E7%9A%84%E6%B5%8B%E8%AF%95/avatar.gif" alt="avatar" /></p>]]>
    </summary>
    <title>Hexo的测试</title>
    <updated>2026-02-13T13:11:45.715Z</updated>
  </entry>
  <entry>
    <author>
      <name>John Doe</name>
    </author>
    <category term="issue" scheme="https://imouyo.github.io/tags/issue/"/>
    <content>
      <![CDATA[<p>需要的工具Typora，VScode(记事本也可以)</p><p>配置环境：hexo: 8.1.1，hexo-cli: 4.3.2，node: 20.19.5，os: win32 10.0.19045 undefined</p><hr /><h3 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h3><p>在使用Hexo编写博客时，会遇到插入图片要么本地端可以预览可以，但上传到github端，就无法显示，或者是反过来的情况，这令人非常难受。Hexo官方提供了两种存储图片的策略，分别是使用<a href="https://hexo.io/zh-cn/docs/asset-folders">全局资源文件夹和文章资源文件夹</a>，</p><p>对于使用全局资源文件夹，我们可以把图片全都放在，<code>博客根目录下的/source/images</code>文件夹内，并在编写博客时使用<code>![](../images/photo.jpg)</code>即可解决图片本地端预览不显示问题，并且上传到github端也可以显示。</p><p>但是可能是hexo版本的问题或者是安装的主题问题，在我新创建<code>hexo 8.1.1</code>版本下使用上述的方法，可以解决图片两端预览同步显示的问题，但在之前的版本图片却只能在本地端预览，无法在github端显示。</p><p>对于使用文章资源文件夹，是无法通过类似的方法解决两端图片显示的问题，除非安装插件之类的。虽说官方提供了使用相对路径引用的标签插件来解决，但是插件插入图片书写格式为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% asset_path slug %&#125;</span><br><span class="line">&#123;% asset_img slug [title] %&#125;</span><br><span class="line">&#123;% asset_link slug [title] %&#125;</span><br></pre></td></tr></table></figure><p>本人觉得十分麻烦，仅代表个人意见</p><p>综上所述，本文提供一种基于js的解决办法。</p><hr /><h3 id="原理"><a class="markdownIt-Anchor" href="#原理"></a> 原理</h3><p>在执行hexo g之后，会将文章编译成html文件，如果为每篇文章都插入一段js代码，代码的作用是修改该文章中的图片的src路径，代码如下，那么理论上就可以实现在本地的编辑markdown文本时使用一个文件夹存放图片，在执行完hexo g并运行后会使得每篇文章中的每个图片的scr路径重新定位，使其指向正确的图片存放位置，这样就实现了本地编辑时和运行后都可以看到插入的图片。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 由deepseek生成，不保证每人都适用，(但我几个朋友的给我说没问题，能正常运行) --&gt;</span><br><span class="line">&lt;!-- 测试标记：看这个会不会出现在生成的<span class="variable constant_">HTML</span>中 --&gt;</span><br><span class="line">&lt;!-- <span class="variable constant_">PARTIAL_IMAGE_FIXER_START</span> --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 配置选项</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> config = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 需要替换的路径规则</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">rules</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">pattern</span>: <span class="string">&#x27;^&lt;%- page.title %&gt;/&#x27;</span>,           <span class="comment">// 匹配以 /images/ 开头的路径</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">replace</span>: <span class="string">&#x27;&#x27;</span>       <span class="comment">// 替换为 /assets/images/</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">pattern</span>: <span class="string">&#x27;^&lt;%- encodeURIComponent(page.title) %&gt;/&#x27;</span>,   <span class="comment">//解决中文问题</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">replace</span>: <span class="string">&#x27;&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    ],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 排除外部链接</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">excludeExternal</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 是否显示调试信息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">debug</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 执行修改</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">function</span> <span class="title function_">fixImagePaths</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> images = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;img&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">for</span> (<span class="keyword">let</span> img <span class="keyword">of</span> images) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> src = img.<span class="title function_">getAttribute</span>(<span class="string">&#x27;src&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 跳过空值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!src) <span class="keyword">continue</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 跳过外部链接（如果配置排除）</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (config.<span class="property">excludeExternal</span> &amp;&amp; src.<span class="title function_">match</span>(<span class="regexp">/^(https?:)?\/\//</span>)) <span class="keyword">continue</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> originalSrc = src;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 应用所有替换规则</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">for</span> (<span class="keyword">let</span> rule <span class="keyword">of</span> config.<span class="property">rules</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="title class_">RegExp</span>(rule.<span class="property">pattern</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (regex.<span class="title function_">test</span>(src)) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          src = src.<span class="title function_">replace</span>(regex, rule.<span class="property">replace</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 如果路径改变了，更新图片 src</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (src !== originalSrc) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        img.<span class="property">src</span> = src;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span> (config.<span class="property">debug</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;✅ 图片路径已修改:&#x27;</span>, originalSrc, <span class="string">&#x27;→&#x27;</span>, src);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 在多个时机执行，确保修改生效</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">readyState</span> === <span class="string">&#x27;loading&#x27;</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, fixImagePaths);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">fixImagePaths</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 如果是 SPA 或有动态加载的内容，可以监听 DOM 变化</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="keyword">function</span>(<span class="params">mutations</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    mutations.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">mutation</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (mutation.<span class="property">addedNodes</span>.<span class="property">length</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">fixImagePaths</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  observer.<span class="title function_">observe</span>(<span class="variable language_">document</span>.<span class="property">body</span>, &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">childList</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">subtree</span>: <span class="literal">true</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;)();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;!-- <span class="variable constant_">PARTIAL_IMAGE_FIXER_END</span> --&gt;</span><br></pre></td></tr></table></figure><hr /><h3 id="hexo目录参考"><a class="markdownIt-Anchor" href="#hexo目录参考"></a> Hexo目录参考：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">├── _config.yml                 </span><br><span class="line">├── node_modules                </span><br><span class="line">├── package-lock.json        </span><br><span class="line">├── package.json                </span><br><span class="line">├── scaffolds                        </span><br><span class="line">├── source                            </span><br><span class="line">└── themes                            </span><br><span class="line">    ├── landscape</span><br><span class="line">    └── pure                // 自建的主题目录</span><br><span class="line">        ├── _config.yml     // 主题配置文件</span><br><span class="line">        ├── layout          // 主要构造 html 的模板</span><br><span class="line">        │   ├── index.ejs   // 主页模板</span><br><span class="line">        │   ├── layout.ejs  // 布局模板</span><br><span class="line">        │   ├── post.ejs    // md 编译成 html 后的文件模板</span><br><span class="line">        │   └── _script</span><br><span class="line">        │       └──image-fixer.ejs//修改图片定位</span><br><span class="line">        └── source          // 静态资源文件目录</span><br><span class="line">            ├── css         // css 样式目录</span><br><span class="line">            └── js          // JavaScript 脚本目录</span><br><span class="line">            </span><br></pre></td></tr></table></figure><hr /><h3 id="代码中config解释"><a class="markdownIt-Anchor" href="#代码中config解释"></a> 代码中config解释</h3><p>​仅需要考虑这一部分代码即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 配置选项</span></span><br><span class="line">  <span class="keyword">const</span> config = &#123;</span><br><span class="line">    <span class="comment">// 需要替换的路径规则</span></span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 该行代码表示要匹配的图片src路径←---------------看这里</span></span><br><span class="line">        <span class="attr">pattern</span>: <span class="string">&#x27;^&lt;%- page.title %&gt;/&#x27;</span>,           <span class="comment">// 匹配以 images/ 开头的路径</span></span><br><span class="line">        <span class="comment">// 表示要将上面匹配到的路径修改  ←---------------看这里</span></span><br><span class="line">        <span class="attr">replace</span>: <span class="string">&#x27;&#x27;</span>       <span class="comment">//替换为 &#x27;&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">pattern</span>: <span class="string">&#x27;^&lt;%- encodeURIComponent(page.title) %&gt;/&#x27;</span>,   <span class="comment">//解决中文问题</span></span><br><span class="line">        <span class="attr">replace</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 排除外部链接，指是否排除markdown加入的网络图片←---------------看这里</span></span><br><span class="line">    <span class="attr">excludeExternal</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 是否显示调试信息，指是否在控制台打印报告      ←---------------看这里</span></span><br><span class="line">    <span class="attr">debug</span>: <span class="literal">true</span></span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure><p>这是上面debug开启的输出，关闭则不会输出结果</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260213205157781.png" alt="image-20260213205157781" /></p><hr /><h3 id="使用全局资源文件夹解决"><a class="markdownIt-Anchor" href="#使用全局资源文件夹解决"></a> 使用全局资源文件夹解决</h3><p><a href="https://hexo.io/zh-cn/docs/asset-folders">点我查看官方解释</a></p><h4 id="原理-2"><a class="markdownIt-Anchor" href="#原理-2"></a> 原理</h4><p><code>Hexo</code>每次<code>generate</code>时都会将博客根目录的<code>source</code>和主题目录下的<code>source</code>中的内容都添加生成，比如</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260213214052307.png" alt="image-20260213214052307" /></p><p>在执行<code>hexo g</code>命令之后这两个文件夹下的内容都会生成到<code>public</code>文件夹中，比如：</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260213215009207.png" alt="image-20260213215009207" /></p><p>所以我们可以修改代码中的<code>config</code>内的值来达到我们的目的</p><hr /><p>! ! ! 注意：如果images文件夹下没有内容，则在public中不会生成该文件夹</p><hr /><h4 id="方法一"><a class="markdownIt-Anchor" href="#方法一"></a> 方法一</h4><hr /><p>我们直接将所有的图片均存储到，<code>博客根目录/source/images</code>，文件夹中，那么在markdown中使用相对路径访问图片应该类似写为<code>../images/photo.jpg</code>，然后就可以解决了，在<code>hexo g</code>生成之后会自动找到正确路径</p><p>如果该方法没有解决问题，请看办法二</p><hr /><h4 id="方法二"><a class="markdownIt-Anchor" href="#方法二"></a> 方法二</h4><p>同样，我们将所有的图片均存储到images文件夹中，那么在markdown中使用相对路径访问图片应该类似写为<code>../images/photo.jpg</code></p><p>但hexo g之后的文章将会变为html存放在public的子文件夹中，比如：</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260213214616353.png" alt="image-20260213214616353" /></p><p>所以我们要把图片的访问路径修改为…/…/…/…/images/photo.jpg，该路径的意思是，基于上图中的index.html所在的文件夹，逐渐向外查找4层到达public文件夹，然后再查找public文件夹下的images文件夹中的photo.jpg</p><p><strong>代码修改</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">rules</span>: [</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">pattern</span>: <span class="string">&#x27;^images/&#x27;</span>,           <span class="comment">// 匹配以 images/ 开头的路径</span></span><br><span class="line">       <span class="attr">replace</span>: <span class="string">&#x27;../../../../images/&#x27;</span>       <span class="comment">// 替换为 ../../../../images/</span></span><br><span class="line">     &#125;</span><br><span class="line">    &lt;!-- 这一段代码可以直接删除了</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">pattern</span>: <span class="string">&#x27;^&lt;%- encodeURIComponent(page.title) %&gt;/&#x27;</span>,   <span class="comment">//解决中文问题</span></span><br><span class="line">       <span class="attr">replace</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">     &#125; --&gt;     </span><br></pre></td></tr></table></figure><h4 id="优缺点"><a class="markdownIt-Anchor" href="#优缺点"></a> 优缺点</h4><p>1、<strong>文章与其使用资源分类不明确</strong></p><p>2、<strong>若多篇文章引用同一个图片，则该图片仅会保存一份</strong></p><hr /><h3 id="使用文章资源文件夹解决"><a class="markdownIt-Anchor" href="#使用文章资源文件夹解决"></a> 使用文章资源文件夹解决</h3><p><a href="https://hexo.io/zh-cn/docs/asset-folders">点我查看官方解释</a></p><h4 id="原理-3"><a class="markdownIt-Anchor" href="#原理-3"></a> 原理</h4><p>​在设置博客根目录下<code>_config.yml</code>中<code>post_asset_folder</code>字段设置为<code>true</code>之后，Hexo将会在你每一次通过 <code>hexo new [layout] &lt;title&gt;</code> 命令创建新文章时自动创建一个资源文件夹。 这个资源文件夹将会有与这个文章文件一样的名字。 将所有与你的文章有关的资源放在这个关联文件夹中之后，你可以通过相对路径来引用它们。并且在执行<code>hexo g</code>命令后资源文件夹中的内容将会复制到与文章相同的目录下，比如，这是hexo生成前存放文章的目录</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260213212015668.png" alt="image-20260213212015668" /></p><p>在执行hexo g后这里的文章将会生成到public文件夹中，例如</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260213212213760.png" alt="image-20260213212213760" /></p><p><strong>可以对比下图上的路径</strong></p><p><strong>我们可以把markdown中图片的相对路径修改一下，使图片指向正确的路径</strong></p><p>1、将博客根目录下<code>_config.yml</code>中<code>post_asset_folder</code>字段设置为<code>true</code></p><p>2、创建文件，位于<code>themes/你当前使用的主题/layout/_script/image-fixer.ejs</code>，并将上述代码拷贝其中</p><p>Ps：如果在<code>themes</code>下无主题文件夹，可前往<code>node_modules/hexo-theme-你当前使用的主题名/layout/_script/image-fixer.ejs</code>创建</p><p>3、在<code>当前使用的主题/layout</code>下<code>post.ejs</code>中导入该文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- partial(&#x27;_script/image-fixer&#x27;) %&gt;</span><br></pre></td></tr></table></figure><p>4、找到Typora中的设置–&gt;偏好设置–&gt;图像，按照下图修改，其中3强烈建议勾选，这样会节省你很多时间</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260213212841806.png" alt="image-20260213212841806" /></p><h4 id="优缺点-2"><a class="markdownIt-Anchor" href="#优缺点-2"></a> <strong>优缺点</strong></h4><p>1、<strong>可以使文章与其使用资源分类更明确</strong></p><p>2、<strong>若多篇文章引用同一个图片，则会占据多份存储空间</strong></p><hr /><h3 id="综合方法"><a class="markdownIt-Anchor" href="#综合方法"></a> 综合方法</h3><h4 id="方法一-2"><a class="markdownIt-Anchor" href="#方法一-2"></a> 方法一</h4><p>如果你即想要资源分类明确，还不想存储多份图片，那么你可以在使用全局资源文件夹解决中的方法一的基础上，在images文件夹内部创建以各文章标题的文件夹比如有篇文章名字为demo，比如创建以下文件夹，然后将公共的图片存放在images中，各文章的图片存放在images下的子文件夹中即可</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260214004426816.png" alt="image-20260214004426816" /></p><p>如果该方法不行，则在该方法基础上加入方法二即可，也就是在上述的综合方法的基础上，继续添加使用全局资源文件夹中的方法二，因为如果使用综合方法，那么在文章中本地图片的路径有两种<code>../images/avatar.gif</code>和<code>../images/demo/bf8c5664.png</code>所以经过全局资源文件夹解决中的方法二的js转换后依然能够定位到正确的路径</p><p>采用该方法还需要配置Typora</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260214011333698.png" alt="image-20260214011333698" /></p><hr /><h3 id="综上所述"><a class="markdownIt-Anchor" href="#综上所述"></a> 综上所述</h3><p>使用全局资源文件夹和文章资源文件夹，各有优劣，可以依靠自己的需求进行取舍。</p><hr /><h3 id="遇到的问题"><a class="markdownIt-Anchor" href="#遇到的问题"></a> 遇到的问题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1、Failed to connect to github.com port 443 after 21085 ms: Could not connect to server</span><br></pre></td></tr></table></figure><p>​<strong>我采用的是ssh连接github</strong></p><p>​1、打开github看能不能连接上，可以连接上继续下一步</p><p>​2、测试ssh -T git@是否能通，能通继续下一步</p><p>​3、上传的图片太多了，总数据量大，删除点图片</p><p>​4、如果还不行，那就的多<code>hexo d</code>几次，估计是网络问题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2、ssh: connect to host github.com port 22[443]: Connection refused</span><br></pre></td></tr></table></figure><p>​把<code>steamcommunity</code>关掉</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3、如果修改过markdown内部标题，比如：这里的title</span><br></pre></td></tr></table></figure><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260213235730583.png" alt="image-20260213235730583" /></p><p>​则需要保证下图所框选的文字需要保持一致，注意：图片有可能不止一张</p><p><img src="%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/image-20260214000017704.jpg" alt="image-20260214000017704" /></p>]]>
    </content>
    <id>https://imouyo.github.io/2026/02/13/%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/</id>
    <link href="https://imouyo.github.io/2026/02/13/%E8%A7%A3%E5%86%B3Hexo%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E4%B8%8D%E6%98%BE%E7%A4%BA/"/>
    <published>2026-02-13T11:33:32.000Z</published>
    <summary>
      <![CDATA[<p>需要的工具Typora，VScode(记事本也可以)</p>
<p>配置环境：hexo: 8.1.1，hexo-cli: 4.3.2，node: 20.19.5，os: win32 10.0.19045 undefined</p>
<hr />
<h3 id="前言"><a]]>
    </summary>
    <title>解决Hexo插入图片本地预览不显示</title>
    <updated>2026-02-13T17:13:51.356Z</updated>
  </entry>
  <entry>
    <author>
      <name>John Doe</name>
    </author>
    <content>
      <![CDATA[<h2 id="aop"><a class="markdownIt-Anchor" href="#aop"></a> AOP</h2><p><strong>1、案例：统计部门管理各个业务层方法执行耗时。</strong></p><p>1). 导入依赖：在 pom.xml 文件中导入 AOP 的依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2). 编写AOP程序：针对于特定方法根据业务需要进行编程</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span><span class="comment">//进行IOC管理</span></span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">//当前类为切面类</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecordTimeAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.itheima.service.impl.DeptServiceImpl.*(..))&quot;)</span><span class="comment">//表明应用于那些方法</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">recordTime</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">//记录方法执行开始时间</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行原始方法</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> pjp.proceed();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//记录方法执行结束时间</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//计算方法执行耗时getSignature方法可以获取当前运行的方法名</span></span><br><span class="line">        log.info(<span class="string">&quot;方法&#123;&#125;执行耗时: &#123;&#125;毫秒&quot;</span>,pjp.getSignature,end-begin);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="通知"><a class="markdownIt-Anchor" href="#通知"></a> 通知</h3><table><thead><tr><th><strong>Spring AOP 通知类型</strong></th><th></th></tr></thead><tbody><tr><td>@Around</td><td>环绕通知，此注解标注的通知方法在目标方法前、后都被执行</td></tr><tr><td>@Before</td><td>前置通知，此注解标注的通知方法在目标方法前被执行</td></tr><tr><td>@After</td><td>后置通知，此注解标注的通知方法在目标方法后被执行，无论是否有异常都会执行</td></tr><tr><td>@AfterReturning</td><td>返回后通知，此注解标注的通知方法在目标方法后被执行，有异常不会执行</td></tr><tr><td>@AfterThrowing</td><td>异常后通知，此注解标注的通知方法发生异常后执行</td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect1</span> &#123;</span><br><span class="line">    <span class="comment">//前置通知</span></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.itheima.service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(JoinPoint joinPoint)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;before ...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//环绕通知</span></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.itheima.service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        log.info(<span class="string">&quot;around before ...&quot;</span>);<span class="comment">//这部分是原始方法之前</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//调用目标对象的原始方法执行</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> proceedingJoinPoint.proceed();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//原始方法如果执行时有异常，环绕通知中的后置代码不会在执行了</span></span><br><span class="line">        </span><br><span class="line">        log.info(<span class="string">&quot;around after ...&quot;</span>);<span class="comment">//这部分是原始方法之后</span></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//后置通知</span></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.itheima.service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">(JoinPoint joinPoint)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;after ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回后通知（程序在正常执行的情况下，会执行的后置通知）</span></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;execution(* com.itheima.service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">(JoinPoint joinPoint)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;afterReturning ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//异常通知（程序在出现异常的情况下，执行的后置通知）</span></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;execution(* com.itheima.service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowing</span><span class="params">(JoinPoint joinPoint)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;afterThrowing ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="注解pointcut"><a class="markdownIt-Anchor" href="#注解pointcut"></a> 注解<code>@PointCut</code></h4><p>该注解的作用是将公共的切入点表达式抽取出来，需要用到时引用该切入点表达式即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect1</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//切入点方法（公共的切入点表达式）</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.itheima.service.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//前置通知（引用切入点）</span></span><br><span class="line">    <span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(JoinPoint joinPoint)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;before ...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//环绕通知</span></span><br><span class="line">    <span class="meta">@Around(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">........</span><br><span class="line">        </span><br><span class="line">    .........</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="在使用通知时的注意事项"><a class="markdownIt-Anchor" href="#在使用通知时的注意事项"></a> 在使用通知时的注意事项：</h4><ul><li>@Around环绕通知需要自己调用 ProceedingJoinPoint.proceed() 来让原始方法执行，其他通知不需要考虑目标方法执行</li><li>@Around环绕通知方法的返回值，必须指定为Object，来接收原始方法的返回值，否则原始方法执行完毕，是获取不到返回值的。</li></ul><h4 id="通知顺序"><a class="markdownIt-Anchor" href="#通知顺序"></a> 通知顺序</h4><p>当在项目开发当中，我们定义了多个切面类，而多个切面类中多个切入点都匹配到了同一个目标方法。此时当目标方法在运行的时候，这多个切面类当中的这些通知方法都会运行。</p><p>例如：</p><p><img src="AOP/image-20260201193519951.png" alt="image-20260201193519951" /></p><ul><li>在不同切面类中，默认按照切面类的类名字母排序：<ul><li>目标方法前的通知方法：字母排名靠前的先执行</li><li>目标方法后的通知方法：字母排名靠前的后执行</li></ul></li></ul><p>如果我们想控制通知的执行顺序有两种方式：</p><ol><li>修改切面类的类名（这种方式非常繁琐、而且不便管理）</li><li>使用Spring提供的<code>@Order</code>注解</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(2)</span>  <span class="comment">//切面类的执行顺序（前置通知：数字越小先执行; 后置通知：数字越小越后执行）</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect2</span> &#123;...&#125;</span><br></pre></td></tr></table></figure><hr /><h4 id="切入点表达式"><a class="markdownIt-Anchor" href="#切入点表达式"></a> 切入点表达式</h4><hr /><p><img src="AOP/image-20260201194215406.png" alt="image-20260201194215406" /></p><hr /><h5 id="execution"><a class="markdownIt-Anchor" href="#execution"></a> execution</h5><p>execution主要根据方法的返回值、包名、类名、方法名、方法参数等信息来匹配，语法为：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(访问修饰符?  返回值  包名.类名.?方法名(方法参数) <span class="keyword">throws</span> 异常?)</span><br></pre></td></tr></table></figure><p>其中带<code>?</code>的表示可以省略的部分</p><ul><li>访问修饰符：可省略（比如: public、protected）</li><li>包名.类名： 可省略   可以直接写方法名，不推荐省略</li><li>throws 异常：可省略（注意是方法上声明抛出的异常，不是实际抛出的异常）</li></ul><p>示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before(&quot;execution(void com.itheima.service.impl.DeptServiceImpl.delete(java.lang.Integer))&quot;)</span></span><br></pre></td></tr></table></figure><p>可以使用通配符描述切入点</p><ul><li><code>*</code> ：单个独立的任意符号，可以通配任意返回值、包名、类名、方法名、任意类型的一个参数，也可以通配包、类、方法名的一部分</li><li><code>..</code> ：多个连续的任意符号，可以通配任意层级的包，或任意类型、任意个数的参数</li></ul><h5 id="切入点表达式的语法规则"><a class="markdownIt-Anchor" href="#切入点表达式的语法规则"></a> 切入点表达式的语法规则：</h5><ol><li>方法的访问修饰符可以省略</li><li>返回值可以使用<code>*</code>号代替（任意返回值类型）</li><li>包名可以使用<code>*</code>号代替，代表任意包（一层包使用一个<code>*</code>）</li><li>使用<code>..</code>配置包名，标识此包以及此包下的所有子包</li><li>类名可以使用<code>*</code>号代替，标识任意类</li><li>方法名可以使用<code>*</code>号代替，表示任意方法，并且方法一部分+<code>*</code>表示方法名中需要包括这一部分的方法</li><li>可以使用 <code>*</code>  配置参数，一个任意类型的参数</li><li>可以使用<code>..</code> 配置参数，任意个任意类型的参数</li></ol><h5 id="切入点表达式示例"><a class="markdownIt-Anchor" href="#切入点表达式示例"></a> <strong>切入点表达式示例</strong></h5><ul><li>省略方法的修饰符号</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(<span class="keyword">void</span> com.itheima.service.impl.DeptServiceImpl.delete(java.lang.Integer))</span><br></pre></td></tr></table></figure><ul><li>使用<code>*</code>代替返回值类型</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com.itheima.service.impl.DeptServiceImpl.delete(java.lang.Integer))</span><br></pre></td></tr></table></figure><ul><li>使用<code>*</code>代替包名（一层包使用一个<code>*</code>）</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com.itheima.*.*.DeptServiceImpl.delete(java.lang.Integer))</span><br></pre></td></tr></table></figure><ul><li>使用<code>..</code>省略包名</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com..DeptServiceImpl.delete(java.lang.Integer))  </span><br></pre></td></tr></table></figure><ul><li>使用<code>*</code>代替类名</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com..*.delete(java.lang.Integer))</span><br></pre></td></tr></table></figure><ul><li>使用<code>*</code>代替方法名</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com..*.*(java.lang.Integer))</span><br></pre></td></tr></table></figure><ul><li>使用 <code>*</code> 代替参数</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com.itheima.service.impl.DeptServiceImpl.delete(*))</span><br></pre></td></tr></table></figure><ul><li>使用<code>..</code>省略参数</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com..*.*(..))</span><br></pre></td></tr></table></figure><p>​</p><h5 id="注意事项"><a class="markdownIt-Anchor" href="#注意事项"></a> <strong>注意事项：</strong></h5><ul><li>根据业务需要，可以使用 且（&amp;&amp;）、或（||）、非（!） 来组合比较复杂的切入点表达式。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com.itheima.service.DeptService.list(..)) || execution(* com.itheima.service.DeptService.delete(..))</span><br></pre></td></tr></table></figure><h5 id="切入点表达式书写建议"><a class="markdownIt-Anchor" href="#切入点表达式书写建议"></a> <strong>切入点表达式书写建议：</strong></h5><ul><li>所有业务方法名在命名时尽量规范，方便切入点表达式快速匹配。如：findXxx，updateXxx。</li><li>描述切入点方法通常基于接口描述，而不是直接描述实现类，增强拓展性。</li><li>在满足业务需要的前提下，尽量缩小切入点的匹配范围。如：包名尽量不使用…，使用 <code>*</code> 匹配单个包。</li></ul><hr /><h3 id="joinpoint"><a class="markdownIt-Anchor" href="#joinpoint"></a> JoinPoint</h3><p>在Spring中用JoinPoint抽象了连接点，用它可以获得方法执行时的相关信息，如目标类名、方法名、方法参数等。</p><h3 id="threadlocal"><a class="markdownIt-Anchor" href="#threadlocal"></a> ThreadLocal</h3><ul><li>ThreadLocal 并不是一个Thread，而是Thread的局部变量。</li><li>ThreadLocal为每个线程提供一份单独的存储空间，具有线程隔离的效果，不同的线程之间不会相互干扰。</li></ul><p><img src="AOP/4f079457-a3e6-451d-ba6a-c0f78e805a9a.png" alt="飞书文档 - 图片" /></p><ul><li>常见方法：<ul><li><code>public void set(T value)`` </code>  设置当前线程的线程局部变量的值</li><li><code>public T get()`` </code>                    返回当前线程所对应的线程局部变量的值</li><li><code>public void remove()`` </code>         移除当前线程的线程局部变量</li></ul></li></ul><p><strong>在同一个线程中实现不同类之间的数据共享</strong></p><p><img src="AOP/59f30a17-eb7f-486a-85cd-9426d467862c-17709763055312-17709818727601.png" alt="" /></p><p><strong>案例：记录当前登录员工</strong></p><p>1、定义ThreadLocal操作的工具类，用于操作当前登录员工ID。后者不用定义，直接用当前线程的TreadLocal也可以。</p><p>在 <code>com.itheima.utils</code> 引入工具类 <code>CurrentHolder</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CurrentHolder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;Integer&gt; CURRENT_LOCAL = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setCurrentId</span><span class="params">(Integer employeeId)</span> &#123;</span><br><span class="line">        CURRENT_LOCAL.set(employeeId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title function_">getCurrentId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> CURRENT_LOCAL.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">()</span> &#123;</span><br><span class="line">        CURRENT_LOCAL.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、在<code>TokenFilter</code>中，解析完当前登录员工ID，将其存入ThreadLocal（用完之后需将其删除）。</p><p>3、在AOP程序中，从ThreadLocal中获取当前登录员工的ID。</p><hr /><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>]]>
    </content>
    <id>https://imouyo.github.io/2026/02/13/AOP/</id>
    <link href="https://imouyo.github.io/2026/02/13/AOP/"/>
    <published>2026-02-13T09:09:03.000Z</published>
    <summary>
      <![CDATA[<h2 id="aop"><a class="markdownIt-Anchor" href="#aop"></a> AOP</h2>
<p><strong>1、案例：统计部门管理各个业务层方法执行耗时。</strong></p>
<p>1). 导入依赖：在 pom.xml 文件]]>
    </summary>
    <title>AOP</title>
    <updated>2026-02-13T11:24:38.990Z</updated>
  </entry>
  <entry>
    <author>
      <name>John Doe</name>
    </author>
    <category term="数据库" scheme="https://imouyo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    <category term="数据库查询" scheme="https://imouyo.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9F%A5%E8%AF%A2/"/>
    <content>
      <![CDATA[<h2 id="mybatis"><a class="markdownIt-Anchor" href="#mybatis"></a> MyBatis</h2><hr /><h3 id="准备工作"><a class="markdownIt-Anchor" href="#准备工作"></a> 准备工作</h3><ol><li><p>创建springboot时添加MySQL Driver和MyBatis Framework的依赖</p></li><li><p>创建需要接受数据的实体类User，类中的属性名必须和字段名一一对应，顺序可以不同实体类放在 <code>com.itheima.pojo</code> 包下。</p></li><li><p>在 <code>application.properties</code> 中配置数据库的连接信息。</p> <figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据库访问的url地址</span></span><br><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/web</span></span><br><span class="line"><span class="comment">#数据库驱动类类名</span></span><br><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="comment">#访问数据库-用户名</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="comment">#访问数据库-密码</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">root@1234</span></span><br></pre></td></tr></table></figure></li><li><p><strong>编写Mybatis程序：编写Mybatis的持久层接口，定义SQL语句（注解）</strong></p><p>在创建出来的springboot工程中，在引导类所在包下，在创建一个包 <code>mapper</code> 。在 <code>mapper</code> 包下创建一个接口 <code>UserMapper</code> ，这是一个持久层接口（Mybatis的持久层接口规范一般都叫 XxxMapper）。</p><p>UserMapper接口的内容如下：</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.itheima.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询全部</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>注解说明：</strong></p><ul><li>@Mapper注解：表示是mybatis中的Mapper接口</li></ul><p>程序运行时，框架会自动生成接口的实现类对象(代理对象)，并给交Spring的IOC容器管理</p><ul><li>@Select注解：代表的就是select查询，用于书写select查询语句</li></ul></li></ol><hr /><h3 id="删除"><a class="markdownIt-Anchor" href="#删除"></a> 删除</h3><ul><li><p>求：根据ID删除用户信息</p></li><li><p>SQL：delete from user where id = 5;</p></li><li><p>Mapper接口方法：</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id删除</span></span><br><span class="line"><span class="comment"> * 在Mybatis中，我们可以通过参数占位符号 #&#123;...&#125; 来占位，在调用deleteById方法时，传递的参数值，最终会替换占位符。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Delete(&quot;delete from user where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure></li><li><p>Mybatis的提供的符号，有两个，一个是 <code>#{...}</code>，另一个是 <code>${...}</code>，区别如下：</p></li></ul><table><thead><tr><th style="text-align:left">符号</th><th>说明</th><th>场景</th><th>优缺点</th></tr></thead><tbody><tr><td style="text-align:left">#{…}</td><td>占位符。执行时，会将#{…}替换为?，生成预编译SQL</td><td>参数值传递</td><td>安全、性能高 （推荐）</td></tr><tr><td style="text-align:left">${…}</td><td>拼接符。直接将参数拼接在SQL语句中，存在SQL注入问题</td><td>表名、字段名动态设置时使用</td><td>不安全、性能低</td></tr></tbody></table><hr /><h3 id="添加"><a class="markdownIt-Anchor" href="#添加"></a> 添加</h3><ul><li>需求：添加一个用户</li><li>SQL：insert into user(username,password,name,age) values(‘zhouyu’,‘123456’,‘周瑜’,20);</li><li>Mapper接口：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加用户</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Insert(&quot;insert into user (username,password,name,age) values (#&#123;username&#125;,#&#123;password&#125;,#&#123;name&#125;,#&#123;age&#125;)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(User user)</span>;</span><br></pre></td></tr></table></figure><p>如果在SQL语句中，我们需要传递多个参数，我们可以把多个参数封装到一个对象中，只需要该对象中的属性值包括这几个参数就可以。然后在SQL语句中，我们可以通过<code>#{对象``属性``名}</code>的方式，获取到对象中封装的属性值。</p><hr /><h3 id="修改"><a class="markdownIt-Anchor" href="#修改"></a> 修改</h3><ul><li>需求：根据ID更新用户信息</li><li>SQL：update user set username = ‘zhouyu’, password = ‘123456’, name = ‘周瑜’, age = 20 where id = 1；</li><li>Mapper接口方法：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id更新用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Update(&quot;update user set username = #&#123;username&#125;,password = #&#123;password&#125;,name = #&#123;name&#125;,age = #&#123;age&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(User user)</span>;</span><br></pre></td></tr></table></figure><hr /><h3 id="查询"><a class="markdownIt-Anchor" href="#查询"></a> 查询</h3><ul><li>需求：根据用户名和密码查询用户信息</li><li>SQL：select* fromuser whereusername = ‘zhouyu’ and password = ‘123456’</li><li>Mapper接口方法：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据用户名和密码查询用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from user where username = #&#123;username&#125; and password = #&#123;password&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">findByUsernameAndPassword</span><span class="params">(<span class="meta">@Param(&quot;username&quot;)</span> String username, <span class="meta">@Param(&quot;password&quot;)</span> String password)</span>;</span><br></pre></td></tr></table></figure><p>@param注解的作用是为接口的方法形参起名字的。（由于用户名唯一的，所以查询返回的结果最多只有一个，可以直接封装到一个对象中）</p><hr /><h3 id="xml映射配置"><a class="markdownIt-Anchor" href="#xml映射配置"></a> XML映射配置</h3><p>Mybatis的开发有两种方式：</p><ol><li>注解</li><li>XML</li></ol><h4 id="xml配置文件规范"><a class="markdownIt-Anchor" href="#xml配置文件规范"></a> XML配置文件规范</h4><p>使用Mybatis的注解方式，主要是来完成一些简单的增删改查功能。如果需要实现复杂的SQL功能，建议使用XML来配置映射语句，也就是将SQL语句写在XML配置文件中。</p><p><strong>在Mybatis中使用XML映射文件方式开发，需要符合一定的规范：</strong></p><ol><li>XML映射文件的名称与Mapper接口名称一致，并且将XML映射文件和Mapper接口放置在相同包下（同包同名）</li><li>XML映射文件的namespace属性为Mapper接口全限定名一致</li><li>XML映射文件中sql语句的id与Mapper接口中的方法名一致，并保持返回类型一致。</li></ol><p><strong>第1步： 创建XML映射文件</strong></p><p>参考上边三点创建</p><p><strong>第2步：编写XML映射文件</strong></p><blockquote><p>xml映射文件中的dtd约束，直接从mybatis官网复制即可; 或者直接AI生成。</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">  <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">  <span class="string">&quot;https://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>第3步：配置</strong></p><p><strong>a. XML映射文件的namespace属性为Mapper接口全限定名</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;https://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.itheima.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>b. XML映射文件中sql语句的id与Mapper接口中的方法名一致，并保持返回类型一致</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;https://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.itheima.mapper.EmpMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--查询操作--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.itheima.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        select * from user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p>resultType 属性的值，与查询返回的单条记录封装的类型一致。</p><h4 id="xml映射文件辅助配置"><a class="markdownIt-Anchor" href="#xml映射文件辅助配置"></a> XML映射文件辅助配置</h4><p>可以在application.properties中配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#指定XML映射配置文件的位置</span><br><span class="line">mybatis.mapper-locations=classpath:mapper/*.xml</span><br></pre></td></tr></table></figure><p>可以不遵循同包这一限制条件</p>]]>
    </content>
    <id>https://imouyo.github.io/2026/02/11/MyBatis/</id>
    <link href="https://imouyo.github.io/2026/02/11/MyBatis/"/>
    <published>2026-02-11T14:27:37.000Z</published>
    <summary>
      <![CDATA[<h2 id="mybatis"><a class="markdownIt-Anchor" href="#mybatis"></a> MyBatis</h2>
<hr />
<h3 id="准备工作"><a class="markdownIt-Anchor" href="#准备工]]>
    </summary>
    <title>MyBatis学习</title>
    <updated>2026-02-12T06:24:03.182Z</updated>
  </entry>
  <entry>
    <author>
      <name>John Doe</name>
    </author>
    <category term="数据库" scheme="https://imouyo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    <category term="MySQL" scheme="https://imouyo.github.io/tags/MySQL/"/>
    <content>
      <![CDATA[<h2 id="mysql"><a class="markdownIt-Anchor" href="#mysql"></a> MySQL</h2><h2 id="启动mysql服务"><a class="markdownIt-Anchor" href="#启动mysql服务"></a> 启动MySQL服务</h2><p>在黑框里敲入<code>net start mysql</code>，回车。</p><p>在黑框里敲入<code>net stop mysql</code>，回车。</p><hr /><h3 id="修改默认账户密码"><a class="markdownIt-Anchor" href="#修改默认账户密码"></a> 修改默认账户密码</h3><p>在黑框里敲入<code>mysqladmin -u root password 1234</code>，这里的<code>1234</code>就是指默认管理员(即root账户)的密码，可以自行修改成你喜欢的。</p><hr /><h3 id="登录"><a class="markdownIt-Anchor" href="#登录"></a> 登录</h3><p>右键开始菜单，选择<code>命令提示符</code>，打开黑框。</p><p>在黑框中输入，<code>mysql -uroot -p1234</code>，回车，出现下图且左下角为<code>mysql&gt;</code>，则登录成功。</p><p>登陆参数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql [<span class="operator">-</span>h数据库服务器的IP地址 <span class="operator">-</span>P端口号] <span class="operator">-</span>u用户名 <span class="operator">-</span>p密码</span><br></pre></td></tr></table></figure><h3 id="退出mysql"><a class="markdownIt-Anchor" href="#退出mysql"></a> 退出mysql：</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure><hr /><h3 id="ddl-对表和库修改"><a class="markdownIt-Anchor" href="#ddl-对表和库修改"></a> DDL-对表和库修改</h3><h4 id="创建数据库"><a class="markdownIt-Anchor" href="#创建数据库"></a> 创建数据库</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database [ if <span class="keyword">not</span> <span class="keyword">exists</span> ] 数据库名  [<span class="keyword">default</span> charset utf8mb4];</span><br></pre></td></tr></table></figure><hr /><h4 id="使用数据库"><a class="markdownIt-Anchor" href="#使用数据库"></a> 使用数据库</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名 ;</span><br></pre></td></tr></table></figure><hr /><h4 id="删除数据库"><a class="markdownIt-Anchor" href="#删除数据库"></a> 删除数据库</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> database [ if <span class="keyword">exists</span> ] 数据库名 ;</span><br></pre></td></tr></table></figure><hr /><h4 id="查询所有数据库"><a class="markdownIt-Anchor" href="#查询所有数据库"></a> 查询所有数据库</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> databases;</span><br></pre></td></tr></table></figure><hr /><h4 id="查询当前数据库"><a class="markdownIt-Anchor" href="#查询当前数据库"></a> 查询当前数据库</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> database();</span><br></pre></td></tr></table></figure><hr /><h4 id="创建表"><a class="markdownIt-Anchor" href="#创建表"></a> 创建表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span>  表名(</span><br><span class="line">        字段<span class="number">1</span>  字段<span class="number">1</span>类型 [约束]  [comment  字段<span class="number">1</span>注释 ],</span><br><span class="line">        字段<span class="number">2</span>  字段<span class="number">2</span>类型 [约束]  [comment  字段<span class="number">2</span>注释 ],</span><br><span class="line">        ......</span><br><span class="line">        字段n  字段n类型 [约束]  [comment  字段n注释 ] </span><br><span class="line">) [ comment  表注释 ] ;</span><br><span class="line"></span><br></pre></td></tr></table></figure><table><thead><tr><th>约束</th><th>描述</th><th>关键字</th></tr></thead><tbody><tr><td>非空约束</td><td>限制该字段值不能为null</td><td>not null</td></tr><tr><td>唯一约束</td><td>保证字段的所有数据都是唯一、不重复的</td><td>unique</td></tr><tr><td>主键约束</td><td>主键是一行数据的唯一标识，要求非空且唯一，<strong>每张表只能有一个主键约束</strong></td><td>primary key</td></tr><tr><td>默认约束</td><td>保存数据时，如果未指定该字段值，则采用默认值</td><td>default</td></tr><tr><td>外键约束</td><td>让两张表的数据建立连接，保证数据的一致性和完整性</td><td>foreign key</td></tr></tbody></table><p>例如</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> tb_user (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment comment <span class="string">&#x27;ID,唯一标识&#x27;</span>,   # id是一行数据的唯一标识（不能重复）</span><br><span class="line">    <span class="comment">-- auto_increment主键自动增长，默认从1开始，如果中途添加了个自己添加的主键，则从该主键开始继续增长</span></span><br><span class="line">    username <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not null</span> <span class="keyword">unique</span> comment <span class="string">&#x27;用户名&#x27;</span>,<span class="comment">-- 用户名非空且唯一</span></span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> comment <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    gender <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;女&#x27;</span> comment <span class="string">&#x27;性别&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;用户表&#x27;</span>;</span><br></pre></td></tr></table></figure><hr /><h4 id="修改表"><a class="markdownIt-Anchor" href="#修改表"></a> 修改表</h4><p>上面讲解了表结构的创建、数据类型、设计表的流程，接下来，再来讲解表结构的查询、修改、删除操作 。</p><ul><li>查询数据库表的具体的语法：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询当前数据库的所有表</span></span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看指定的表结构</span></span><br><span class="line"><span class="keyword">desc</span> 表名 ;   <span class="comment">-- 可以查看指定表的字段、字段的类型、是否可以为NULL、是否存在默认值等信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询指定表的建表语句</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create table</span> 表名 ;</span><br></pre></td></tr></table></figure><ul><li>修改数据库表结构的具体语法：</li></ul><h5 id="添加字段"><a class="markdownIt-Anchor" href="#添加字段"></a> 添加字段</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加字段</span></span><br><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">add</span>  字段名  类型(长度)  [comment 注释]  [约束];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 比如： 为tb_emp表添加字段qq，字段类型为 varchar(11)</span></span><br><span class="line"><span class="keyword">alter table</span> tb_emp <span class="keyword">add</span>  qq  <span class="type">varchar</span>(<span class="number">11</span>) comment <span class="string">&#x27;QQ号码&#x27;</span>;</span><br></pre></td></tr></table></figure><h5 id="修改字段"><a class="markdownIt-Anchor" href="#修改字段"></a> 修改字段</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 修改字段类型</span></span><br><span class="line"><span class="keyword">alter table</span> 表名 modify  字段名  新数据类型(长度);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 比如： 修改qq字段的字段类型，将其长度由11修改为13</span></span><br><span class="line"><span class="keyword">alter table</span> tb_emp modify qq <span class="type">varchar</span>(<span class="number">13</span>) comment <span class="string">&#x27;QQ号码&#x27;</span>;</span><br><span class="line"><span class="comment">-- 修改字段名，字段类型</span></span><br><span class="line"><span class="keyword">alter table</span> 表名 change  旧字段名  新字段名  类型(长度)  [comment 注释]  [约束];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 比如： 修改qq字段名为 qq_num，字段类型varchar(13)</span></span><br><span class="line"><span class="keyword">alter table</span> tb_emp change qq qq_num <span class="type">varchar</span>(<span class="number">13</span>) comment <span class="string">&#x27;QQ号码&#x27;</span>;</span><br></pre></td></tr></table></figure><h5 id="删除字段"><a class="markdownIt-Anchor" href="#删除字段"></a> 删除字段</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除字段</span></span><br><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">drop</span> 字段名;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 比如： 删除tb_emp表中的qq_num字段</span></span><br><span class="line"><span class="keyword">alter table</span> tb_emp <span class="keyword">drop</span> qq_num;</span><br></pre></td></tr></table></figure><h5 id="修改表名"><a class="markdownIt-Anchor" href="#修改表名"></a> 修改表名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 修改表名</span></span><br><span class="line">rename <span class="keyword">table</span> 表名 <span class="keyword">to</span>  新表名;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 比如: 将当前的emp表的表名修改为tb_emp</span></span><br><span class="line">rename <span class="keyword">table</span> emp <span class="keyword">to</span> tb_emp;</span><br></pre></td></tr></table></figure><h5 id="删除表结构"><a class="markdownIt-Anchor" href="#删除表结构"></a> 删除表结构</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除表</span></span><br><span class="line"><span class="keyword">drop</span>  <span class="keyword">table</span> [ if <span class="keyword">exists</span> ]  表名;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 比如：如果tb_emp表存在，则删除tb_emp表</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> tb_emp;  <span class="comment">-- 在删除表时，表中的全部数据也会被删除。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><hr /><h3 id="外键约束"><a class="markdownIt-Anchor" href="#外键约束"></a> 外键约束</h3><p>用于让两张表的数据建立连接，保证数据的一致性和完整性</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表时指定</span></span><br><span class="line"><span class="keyword">create table</span> 表名(</span><br><span class="line">        字段名    数据类型,</span><br><span class="line">        ...</span><br><span class="line">        [<span class="keyword">constraint</span>]   [外键名称]  <span class="keyword">foreign  key</span> (外键字段名)   <span class="keyword">references</span>   主表 (主表列名)        </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 建完表后，添加外键</span></span><br><span class="line"><span class="keyword">alter table</span>  表名  <span class="keyword">add constraint</span>  外键名称  <span class="keyword">foreign key</span>(外键字段名) <span class="keyword">references</span> 主表(主表列名);</span><br></pre></td></tr></table></figure><p>删除外键约束</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 添加外键的表名 drop foreign key 外键名;</span><br></pre></td></tr></table></figure><hr /><h3 id="dml-对表的数据增删改"><a class="markdownIt-Anchor" href="#dml-对表的数据增删改"></a> DML-对表的数据增删改</h3><hr /><p>DML英文全称是Data Manipulation Language(数据操作语言)，用来对数据库中表的数据记录进行增、删、改操作。</p><ul><li>添加数据（INSERT）</li><li>修改数据（UPDATE）</li><li>删除数据（DELETE）</li></ul><h4 id="增加insert"><a class="markdownIt-Anchor" href="#增加insert"></a> 增加(insert)</h4><ol><li><h5 id="语法"><a class="markdownIt-Anchor" href="#语法"></a> <strong>语法</strong></h5></li></ol><ul><li>向指定字段添加数据</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名 (字段名<span class="number">1</span>, 字段名<span class="number">2</span>) <span class="keyword">values</span> (值<span class="number">1</span>, 值<span class="number">2</span>);</span><br></pre></td></tr></table></figure><ul><li>全部字段添加数据</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名 <span class="keyword">values</span> (值<span class="number">1</span>, 值<span class="number">2</span>, ...);</span><br></pre></td></tr></table></figure><ul><li>批量添加数据（指定字段）</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名 (字段名<span class="number">1</span>, 字段名<span class="number">2</span>) <span class="keyword">values</span> (值<span class="number">1</span>, 值<span class="number">2</span>), (值<span class="number">1</span>, 值<span class="number">2</span>);</span><br></pre></td></tr></table></figure><ul><li>批量添加数据（全部字段）</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名 <span class="keyword">values</span> (值<span class="number">1</span>, 值<span class="number">2</span>, ...), (值<span class="number">1</span>, 值<span class="number">2</span>, ...);</span><br></pre></td></tr></table></figure><ol><li><h5 id="案例演示"><a class="markdownIt-Anchor" href="#案例演示"></a> 案例演示</h5></li></ol><ul><li>案例1：向emp表的username, name, gender, phone, create_time, update_time字段插入数据</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 因为设计表时create_time, update_time两个字段不能为NULL，所以也做为要插入的字段</span></span><br><span class="line"><span class="keyword">insert into</span> emp(username, name, gender, phone, create_time, update_time)</span><br><span class="line"><span class="keyword">values</span> (<span class="string">&#x27;wuji&#x27;</span>, <span class="string">&#x27;张无忌&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;13309091231&#x27;</span>, now(), now());</span><br></pre></td></tr></table></figure><ul><li>案例2：向temp表的所有字段插入数据</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> emp2(id, username, password, name, gender, phone, job, salary, image, entry_date, create_time, update_time)</span><br><span class="line">                  <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;shinaian&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;施耐庵&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;13309090001&#x27;</span>,<span class="number">4</span>,<span class="number">15000</span>,<span class="string">&#x27;1.jpg&#x27;</span>,<span class="string">&#x27;2000-01-01&#x27;</span>,now(),now()), <span class="comment">-- id值为null时，若有key自增，则自增       </span></span><br></pre></td></tr></table></figure><ul><li>案例3：批量向emp表的username、name、gender字段插入数据</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> emp(username, name, gender, phone, create_time, update_time)</span><br><span class="line"><span class="keyword">values</span> (<span class="string">&#x27;Tom1&#x27;</span>, <span class="string">&#x27;汤姆1&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;13309091231&#x27;</span>, now(), now()),</span><br><span class="line">       (<span class="string">&#x27;Tom2&#x27;</span>, <span class="string">&#x27;汤姆2&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;13309091232&#x27;</span>, now(), now());</span><br></pre></td></tr></table></figure><h4 id="修改update"><a class="markdownIt-Anchor" href="#修改update"></a> 修改(update)</h4><ol><li><h5 id="语法-2"><a class="markdownIt-Anchor" href="#语法-2"></a> 语法</h5></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> 表名 <span class="keyword">set</span> 字段名<span class="number">1</span> <span class="operator">=</span> 值<span class="number">1</span> , 字段名<span class="number">2</span> <span class="operator">=</span> 值<span class="number">2</span> , .... [<span class="keyword">where</span> 条件] ;</span><br></pre></td></tr></table></figure><ol><li><h5 id="案例演示-2"><a class="markdownIt-Anchor" href="#案例演示-2"></a> 案例演示</h5></li></ol><ul><li>案例1：将emp表中id为1的员工，姓名name字段更新为’张三’</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> emp <span class="keyword">set</span> name<span class="operator">=</span><span class="string">&#x27;张三&#x27;</span>, update_time<span class="operator">=</span>now() <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>修改语句的where条件可以有，也可以没有，如果没有条件，<strong>则会修改整张表的所有数据。</strong></p><ul><li>案例2：将emp表的所有员工入职日期更新为’2010-01-01’</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> emp <span class="keyword">set</span> entry_date<span class="operator">=</span><span class="string">&#x27;2010-01-01&#x27;</span>, update_time<span class="operator">=</span>now();</span><br></pre></td></tr></table></figure><h4 id="删除delete"><a class="markdownIt-Anchor" href="#删除delete"></a> 删除(delete)</h4><ol><li><h5 id="语法-3"><a class="markdownIt-Anchor" href="#语法-3"></a> 语法</h5></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> 表名  [<span class="keyword">where</span>  条件] ;</span><br></pre></td></tr></table></figure><ul><li>DELETE 语句的where条件可以有，也可以没有，如果没有条件，<strong>则会删除整张表的所有数据。</strong></li><li>DELETE 语句不能删除某一个字段的值(可以使用UPDATE，将该字段值置为NULL即可)。</li><li>当进行删除全部数据操作时，会提示询问是否确认删除所有数据，直接点击Execute即可。</li></ul><ol><li><h5 id="案例演示-3"><a class="markdownIt-Anchor" href="#案例演示-3"></a> 案例演示</h5></li></ol><ul><li>案例1：删除emp表中id为1的员工</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> emp <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><ul><li>案例2：删除emp表中所有员工</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tb_emp;</span><br></pre></td></tr></table></figure><hr /><h3 id="dql-查询表中的记录"><a class="markdownIt-Anchor" href="#dql-查询表中的记录"></a> DQL-查询表中的记录</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">        字段列表[]</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">        表名列表[]<span class="comment">-- select 和 from 是必须要有的，其他的可选</span></span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">        条件列表[]</span><br><span class="line"><span class="keyword">GROUP</span>  <span class="keyword">BY</span></span><br><span class="line">        分组字段列表[]</span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line">        分组后条件列表[]</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">        排序字段列表[]</span><br><span class="line">LIMIT</span><br><span class="line">        分页参数</span><br></pre></td></tr></table></figure><h4 id="基本查询"><a class="markdownIt-Anchor" href="#基本查询"></a> 基本查询</h4><p>在基本查询的DQL语句中，不带任何的查询条件。</p><p><strong>语法如下：</strong></p><ul><li>查询多个字段</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段<span class="number">1</span>, 字段<span class="number">2</span>, 字段<span class="number">3</span> <span class="keyword">from</span>  表名;</span><br></pre></td></tr></table></figure><ul><li>查询所有字段（通配符）</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span>  <span class="keyword">from</span>  表名;</span><br></pre></td></tr></table></figure><ul><li>设置别名</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段<span class="number">1</span> [ <span class="keyword">as</span> 别名<span class="number">1</span> ] , 字段<span class="number">2</span> [ <span class="keyword">as</span> 别名<span class="number">2</span> ]  <span class="keyword">from</span>  表名;</span><br></pre></td></tr></table></figure><ul><li>去除重复记录</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> 字段列表 <span class="keyword">from</span>  表名;</span><br></pre></td></tr></table></figure><p><strong>案例演示:</strong></p><ul><li>案例1：查询指定字段 name，entry_date并返回</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,entry_date <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><ul><li>案例2：查询返回所有字段</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><p><strong>* 号代表查询所有字段，在实际开发中尽量少用（不直观、影响效率）</strong></p><ul><li>案例3：查询所有员工的 name, entry_date，并起别名(姓名、入职日期),不会修改原先表项，只是修改返回时的数据</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式1：</span></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">AS</span> 姓名, entry_date <span class="keyword">AS</span> 入职日期 <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2： 别名中有特殊字符时，使用&#x27;&#x27;或&quot;&quot;包含</span></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">AS</span> <span class="string">&#x27;姓 名&#x27;</span>, entry_date <span class="keyword">AS</span> <span class="string">&#x27;入职日期&#x27;</span> <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式3：</span></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">AS</span> 姓名, entry_date <span class="keyword">AS</span> 入职日期 <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><ul><li>案例4：查询已有的员工共有几种职位(不要重复)</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><hr /><h4 id="条件查询"><a class="markdownIt-Anchor" href="#条件查询"></a> 条件查询</h4><p><strong>语法：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段列表  <span class="keyword">from</span>   表名   <span class="keyword">where</span>   条件列表 ; <span class="comment">-- 条件列表：意味着可以有多个条件</span></span><br></pre></td></tr></table></figure><p>学习条件查询就是学习条件的构建方式，而在SQL语句当中构造条件的运算符分为两类：</p><ul><li>比较运算符</li><li>逻辑运算符</li></ul><p>常用的比较运算符如下:</p><table><thead><tr><th>比较运算符</th><th>功能</th></tr></thead><tbody><tr><td>&gt;</td><td>大于</td></tr><tr><td>&gt;=</td><td>大于等于</td></tr><tr><td>&lt;</td><td>小于</td></tr><tr><td>&lt;=</td><td>小于等于</td></tr><tr><td>=</td><td>等于</td></tr><tr><td>&lt;&gt; 或 !=</td><td>不等于</td></tr><tr><td>between … and …</td><td>在某个范围之内(含最小、最大值)</td></tr><tr><td>in(…)</td><td>在in之后的列表中的值，多选一</td></tr><tr><td>like 占位符</td><td>模糊匹配(_匹配单个字符, %匹配任意个字符)</td></tr><tr><td>is null</td><td>是null</td></tr></tbody></table><p>常用的逻辑运算符如下:</p><table><thead><tr><th>逻辑运算符</th><th>功能</th></tr></thead><tbody><tr><td>and 或 &amp;&amp;</td><td>并且 (多个条件同时成立)</td></tr><tr><td>or 或 ||</td><td>或者 (多个条件任意一个成立)</td></tr><tr><td>not 或 !</td><td>非 , 不是</td></tr></tbody></table><ul><li>案例1：查询 姓名 为 ‘杨逍’ 的员工</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;杨逍&#x27;</span>; <span class="comment">-- 字符串使用&#x27;&#x27;或&quot;&quot;包含</span></span><br></pre></td></tr></table></figure><ul><li>案例2：查询 薪资小于等于 5000 的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> salary <span class="operator">&lt;=</span><span class="number">5000</span>;</span><br></pre></td></tr></table></figure><ul><li>案例3：查询 没有分配职位 的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> job <span class="keyword">is</span> <span class="keyword">null</span> ;</span><br></pre></td></tr></table></figure><p>注意：查询为NULL的数据时，不能使用 <code>= null</code> 或 <code>！=null</code> 。得使用 <code>is null</code> 或 <code>is not null</code>。</p><ul><li>案例4：查询 有职位 的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> job <span class="keyword">is</span> <span class="keyword">not null</span> ;</span><br></pre></td></tr></table></figure><ul><li>案例5：查询 密码不等于 ‘123456’ 的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式1：</span></span><br><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> password <span class="operator">&lt;&gt;</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="comment">-- 方式2：</span></span><br><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> password <span class="operator">!=</span> <span class="string">&#x27;123456&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li>案例6：查询 入职日期 在  ‘2000-01-01’ (包含)  到  ‘2010-01-01’(包含) 之间的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式1：</span></span><br><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> entry_date <span class="operator">&gt;=</span> <span class="string">&#x27;2000-01-01&#x27;</span> <span class="keyword">and</span> entry_date <span class="operator">&lt;=</span> <span class="string">&#x27;2010-01-01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2： between...and</span></span><br><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> entry_date <span class="keyword">between</span> <span class="string">&#x27;2000-01-01&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2010-01-01&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li>案例7：查询 入职时间 在 ‘2000-01-01’ (包含) 到 ‘2010-01-01’(包含) 之间 且 性别为女 的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> entry_date <span class="keyword">between</span> <span class="string">&#x27;2000-01-01&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2010-01-01&#x27;</span>;</span><br><span class="line">      <span class="keyword">and</span> gender <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure><ul><li>案例8：查询 职位是 2 (讲师), 3 (学工主管), 4 (教研主管) 的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式1：使用or连接多个条件</span></span><br><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> job<span class="operator">=</span><span class="number">2</span> <span class="keyword">or</span> job<span class="operator">=</span><span class="number">3</span> <span class="keyword">or</span> job<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2：in关键字</span></span><br><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> job <span class="keyword">in</span> (<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br></pre></td></tr></table></figure><ul><li>案例9：查询 姓名 为两个字的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;__&#x27;</span>;  # 通配符 &quot;_&quot; 代表任意<span class="number">1</span>个字符</span><br></pre></td></tr></table></figure><ul><li>案例10：查询 姓 ‘张’ 的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;张%&#x27;</span>; # 通配符 &quot;%&quot; 代表任意个字符（<span class="number">0</span>个 <span class="operator">~</span> 多个）</span><br></pre></td></tr></table></figure><ul><li>案例11：查询 姓名中包含 ‘二’  的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%二%&#x27;</span>; # 通配符 &quot;%&quot; 代表任意个字符（<span class="number">0</span>个 <span class="operator">~</span> 多个）</span><br></pre></td></tr></table></figure><hr /><h4 id="聚合函数"><a class="markdownIt-Anchor" href="#聚合函数"></a> 聚合函数</h4><p>之前我们做的查询都是横向查询，就是根据条件一行一行的进行判断，而使用聚合函数查询就是纵向查询，它是对一列的值进行计算，然后返回一个结果值。（将一列数据作为一个整体，进行纵向计算）</p><p>常用聚合函数：</p><table><thead><tr><th>函数</th><th>功能</th></tr></thead><tbody><tr><td>count</td><td>统计数量</td></tr><tr><td>max</td><td>最大值</td></tr><tr><td>min</td><td>最小值</td></tr><tr><td>avg</td><td>平均值</td></tr><tr><td>sum</td><td>求和</td></tr></tbody></table><p>注意 : 聚合函数会忽略空值，对NULL值不作为统计。</p><ul><li>count ：按照列去统计有多少行数据。<ul><li>在根据指定的列统计的时候，<strong>如果这一列中有null的行，该行不会被统计在其中。</strong></li></ul></li><li>sum ：计算指定列的数值和，如果不是数值类型，那么计算结果为0</li><li>max ：计算指定列的最大值</li><li>min ：计算指定列的最小值</li><li>avg ：计算指定列的平均值</li></ul><p><strong>案例演示:</strong></p><ul><li>案例1：统计该企业员工数量</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- count(字段)</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(id) <span class="keyword">from</span> emp;<span class="comment">-- 结果：30</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(job) <span class="keyword">from</span> emp;<span class="comment">-- 结果：29 （聚合函数对NULL值不做计算）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- count(常量)</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">0</span>) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- count(*)  推荐此写法（MySQL底层进行了优化）</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 优先推荐count(*) 其次是count(常量) 最后是 count(字段)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>案例2：统计该企业员工的平均薪资</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(salary) <span class="keyword">from</span>  emp;</span><br></pre></td></tr></table></figure><ul><li>案例3：统计该企业员工的最低薪资</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(salary) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><ul><li>案例4：统计该企业员工的最高薪资</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(salary) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><ul><li>案例5：统计该企业每月要给员工发放的薪资总额(薪资之和)</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(salary) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><hr /><h4 id="分组查询"><a class="markdownIt-Anchor" href="#分组查询"></a> 分组查询</h4><ul><li>分组： 按照某一列或者某几列，把相同的数据进行合并输出。<ul><li>分组其实就是按列进行分类(指定列下相同的数据归为一类)，然后可以对分类完的数据进行合并计算。</li><li>分组查询通常会使用聚合函数进行计算。</li></ul></li></ul><p><strong>语法：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段列表  <span class="keyword">from</span>  表名  [<span class="keyword">where</span> 条件]  <span class="keyword">group</span> <span class="keyword">by</span> 分组字段名  [<span class="keyword">having</span> 分组后过滤条件];</span><br><span class="line"><span class="comment">-- 分组之后，select后的字段列表不能随意书写，能写的一般是分组字段+聚合函数。</span></span><br></pre></td></tr></table></figure><p><strong>案例演示：</strong></p><ul><li>案例1：根据性别分组 , 统计男性和女性员工的数量</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> gender, <span class="built_in">count</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> gender; <span class="comment">-- 按照gender字段进行分组（gender字段下相同的数据归为一组）</span></span><br></pre></td></tr></table></figure><ul><li>案例2：查询入职时间在 ‘2015-01-01’ (包含) 以前的员工 , 并对结果根据职位分组 , 获取员工数量大于等于2的职位</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> job, <span class="built_in">count</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> entry_date <span class="operator">&lt;=</span> <span class="string">&#x27;2015-01-01&#x27;</span>   <span class="comment">-- 分组前条件</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> job                      <span class="comment">-- 按照job字段分组</span></span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">&gt;=</span> <span class="number">2</span>;             <span class="comment">-- 分组后条件</span></span><br></pre></td></tr></table></figure><p><strong>注意事项:</strong></p><ul><li>分组之后，查询的字段一般为聚合函数和分组字段，查询其他字段无任何意义</li><li>执行顺序：where &gt; 聚合函数 &gt; having</li><li>所以where之后不能执行聚合函数</li></ul><p><strong>where与having区别（面试题）</strong></p><ul><li>执行时机不同：where是分组之前进行过滤，不满足where条件，不参与分组；而having是分组之后对结果进行过滤。</li><li>判断条件不同：where不能对聚合函数进行判断，而having可以。</li></ul><hr /><h4 id="排查查询"><a class="markdownIt-Anchor" href="#排查查询"></a> 排查查询</h4><p>排序在日常开发中是非常常见的一个操作，有升序排序，也有降序排序。</p><p><strong>语法：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段列表  </span><br><span class="line"><span class="keyword">from</span>   表名   </span><br><span class="line">[<span class="keyword">where</span>  条件列表] </span><br><span class="line">[<span class="keyword">group</span> <span class="keyword">by</span>  分组字段 ] </span><br><span class="line"><span class="keyword">order</span>  <span class="keyword">by</span>  字段<span class="number">1</span>  排序方式<span class="number">1</span> , 字段<span class="number">2</span>  排序方式<span class="number">2</span> … ;</span><br></pre></td></tr></table></figure><ul><li>排序方式：<ul><li>ASC ：升序（默认值）</li><li>DESC：降序</li></ul></li></ul><p><strong>案例演示：</strong></p><ul><li>案例1：根据入职时间, 对员工进行升序排序</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> entry_date <span class="keyword">ASC</span>; <span class="comment">-- 按照entrydate字段下的数据进行升序排序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>  entry_date; <span class="comment">-- 默认就是ASC（升序）</span></span><br></pre></td></tr></table></figure><p><strong>注意事项：如果是升序, 可以不指定排序方式ASC</strong></p><ul><li>案例2：根据入职时间，对员工进行降序排序</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> entry_date <span class="keyword">DESC</span>; <span class="comment">-- 按照entrydate字段下的数据进行降序排序</span></span><br></pre></td></tr></table></figure><ul><li>案例3：根据入职时间对公司的员工进行升序排序，入职时间相同，再按照更新时间进行降序排序</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> entry_date <span class="keyword">ASC</span> , update_time <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p><strong>注意事项：如果是多字段排序，当第一个字段值相同时，才会根据第二个字段进行排序</strong></p><hr /><h4 id="分页查询"><a class="markdownIt-Anchor" href="#分页查询"></a> 分页查询</h4><p>分页操作在业务系统开发时，也是非常常见的一个功能，日常我们在网站中看到的各种各样的分页条，后台也都需要借助于数据库的分页操作。</p><p>分页查询语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段列表  <span class="keyword">from</span>  表名  limit  起始索引, 查询记录数 ;</span><br></pre></td></tr></table></figure><ul><li>案例1：从起始索引0开始查询员工数据, 每页展示5条记录</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line">limit <span class="number">0</span> , <span class="number">5</span>; <span class="comment">-- 从索引0开始，向后取5条记录</span></span><br></pre></td></tr></table></figure><ul><li>案例2：查询 第1页 员工数据, 每页展示5条记录</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line">limit <span class="number">5</span>; <span class="comment">-- 如果查询的是第1页数据，起始索引可以省略，直接简写为：limit 条数</span></span><br></pre></td></tr></table></figure><ul><li>案例3：查询 第2页 员工数据, 每页展示5条记录</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line">limit <span class="number">5</span> , <span class="number">5</span>; <span class="comment">-- 从索引5开始，向后取5条记录</span></span><br></pre></td></tr></table></figure><ul><li>案例4：查询 第3页 员工数据, 每页展示5条记录</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, username, password, name, gender, phone, salary, job, image, entry_date, create_time, update_time</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line">limit <span class="number">10</span> , <span class="number">5</span>; <span class="comment">-- 从索引10开始，向后取5条记录</span></span><br></pre></td></tr></table></figure><p><strong>注意事项:</strong></p><ol><li>起始索引从0开始。           计算公式 ：起始索引 = （查询页码 - 1）* 每页显示记录数</li><li>分页查询是数据库的方言，不同的数据库有不同的实现，MySQL中是LIMIT</li><li>如果查询的是第一页数据，起始索引可以省略，直接简写为 limit  条数</li></ol><hr /><h4 id="多表查询"><a class="markdownIt-Anchor" href="#多表查询"></a> 多表查询</h4><p>多表查询：查询时从多张表中获取所需数据</p><blockquote><p>单表查询的SQL语句：select  字段列表  from  表名;</p><p>那么要执行多表查询，只需要使用逗号分隔多张表即可，如： select   字段列表  from  表1, 表2;</p></blockquote><p>查询用户表和部门表中的数据：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>  emp , dept;</span><br></pre></td></tr></table></figure><p>在SQL语句中，如何去除无效的笛卡尔积呢？只需要给多表查询加上连接查询的条件即可。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp , dept <span class="keyword">where</span> emp.dept_id <span class="operator">=</span> dept.id ;</span><br></pre></td></tr></table></figure><h5 id="分类"><a class="markdownIt-Anchor" href="#分类"></a> 分类</h5><p>多表查询可以分为：</p><ol><li>连接查询<ol><li>内连接：相当于查询A、B交集部分数据</li><li>外连接<ul><li>左外连接：查询左表所有数据(包括两张表交集部分数据)</li><li>右外连接：查询右表所有数据(包括两张表交集部分数据)</li></ul></li></ol></li><li>子查询</li></ol><hr /><h5 id="内连接"><a class="markdownIt-Anchor" href="#内连接"></a> 内连接</h5><p>内连接查询：查询两表或多表中交集部分数据。</p><p>内连接从语法上可以分为：</p><ul><li>隐式内连接</li><li>显式内连接</li></ul><p><strong>隐式内连接语法：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段列表   <span class="keyword">from</span>   表<span class="number">1</span> , 表<span class="number">2</span>   <span class="keyword">where</span>  条件 ... ;</span><br></pre></td></tr></table></figure><p><strong>显式内连接语法：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段列表   <span class="keyword">from</span>   表<span class="number">1</span>  [ <span class="keyword">inner</span> ]  <span class="keyword">join</span> 表<span class="number">2</span>  <span class="keyword">on</span>  连接条件 ... ;</span><br></pre></td></tr></table></figure><ul><li><p>案例1：查询所有员工的ID，姓名，及所属的部门名称</p><ul><li><p>隐式内连接实现</p></li><li><pre class="highlight"><code class="SQL">  <span class="keyword">select</span> emp.id, emp.name, dept.name <span class="keyword">from</span> emp , dept <span class="keyword">where</span> emp.dept_id <span class="operator">=</span> dept.id;  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">--code￼72--&gt;</span></code></pre></li><li></li></ul></li><li><p>案例2：查询 性别为男, 且工资 高于8000 的员工的ID, 姓名, 及所属的部门名称</p><ul><li><p>隐式内连接实现</p></li><li><pre class="highlight"><code class="SQL">  <span class="keyword">select</span> emp.id, emp.name, dept.name <span class="keyword">from</span> emp , dept <span class="keyword">where</span> emp.dept_id <span class="operator">=</span> dept.id <span class="keyword">and</span> emp.gender <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> emp.salary <span class="operator">&gt;</span> <span class="number">8000</span>;  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">--code￼73--&gt;</span></code></pre></li><li><p>在多表联查时，我们指定字段时，需要在字段名前面加上表名，来指定具体是哪一张的字段。 如：emp.dept_id</p></li><li></li></ul></li></ul><p><strong>给表起别名简化书写：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段列表 <span class="keyword">from</span> 表<span class="number">1</span> <span class="keyword">as</span> 别名<span class="number">1</span> , 表<span class="number">2</span> <span class="keyword">as</span>  别名<span class="number">2</span>  <span class="keyword">where</span>  条件 ... ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>  字段列表 <span class="keyword">from</span> 表<span class="number">1</span> 别名<span class="number">1</span> , 表<span class="number">2</span>  别名<span class="number">2</span>  <span class="keyword">where</span>  条件 ... ;  <span class="comment">-- as 可以省略</span></span><br></pre></td></tr></table></figure><p>使用了别名的多表查询：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.id, e.name, d.name <span class="keyword">from</span> emp <span class="keyword">as</span> e , dept <span class="keyword">as</span> d <span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id <span class="keyword">and</span> e.gender <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> e.salary <span class="operator">&gt;</span> <span class="number">8000</span>;</span><br></pre></td></tr></table></figure><p><strong>注意事项:</strong> 一旦为表起了别名，就不能再使用表名来指定对应的字段了，此时只能够使用别名来指定字段。<strong>别名仅这一条sql语句有效。</strong></p><hr /><h5 id="外连接"><a class="markdownIt-Anchor" href="#外连接"></a> 外连接</h5><p>外连接分为两种：左外连接 和 右外连接。</p><p><strong>左外连接语法：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段列表   <span class="keyword">from</span>   表<span class="number">1</span>  <span class="keyword">left</span>  [ <span class="keyword">outer</span> ]  <span class="keyword">join</span> 表<span class="number">2</span>  <span class="keyword">on</span>  连接条件 ... ;</span><br></pre></td></tr></table></figure><p>左外连接相当于查询表1(左表)的所有数据，当然也包含表1和表2交集部分的数据。</p><p><strong>右外连接语法：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段列表   <span class="keyword">from</span>   表<span class="number">1</span>  <span class="keyword">right</span>  [ <span class="keyword">outer</span> ]  <span class="keyword">join</span> 表<span class="number">2</span>  <span class="keyword">on</span>  连接条件 ... ;</span><br></pre></td></tr></table></figure><p>右外连接相当于查询表2(右表)的所有数据，当然也包含表1和表2交集部分的数据。</p><p>案例1：查询员工表 所有 员工的姓名, 和对应的部门名称 (左外连接)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 左外连接：以left join关键字左边的表为主表，查询主表中所有数据，以及和主表匹配的右边表中的数据</span></span><br><span class="line"><span class="keyword">select</span> e.name , d.name  <span class="keyword">from</span> emp <span class="keyword">as</span> e <span class="keyword">left</span> <span class="keyword">join</span> dept <span class="keyword">as</span> d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id ;</span><br></pre></td></tr></table></figure><p>案例2：查询部门表 所有 部门的名称, 和对应的员工名称 (右外连接)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 右外连接：以right join关键字右边的表为主表，查询主表中所有数据，以及和主表匹配的左边表中的数据</span></span><br><span class="line"><span class="keyword">select</span> e.name , d.name <span class="keyword">from</span> emp <span class="keyword">as</span> e <span class="keyword">right</span> <span class="keyword">join</span> dept <span class="keyword">as</span> d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br></pre></td></tr></table></figure><p>案例3：查询工资 高于8000 的 所有员工的姓名, 和对应的部门名称 (左外连接)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.name , d.name  <span class="keyword">from</span> emp <span class="keyword">as</span> e <span class="keyword">left</span> <span class="keyword">join</span> dept <span class="keyword">as</span> d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id <span class="keyword">where</span> e.salary <span class="operator">&gt;</span> <span class="number">8000</span>;</span><br></pre></td></tr></table></figure><p><strong>注意事项：</strong></p><p>左外连接和右外连接是可以相互替换的，只需要调整连接查询时SQL语句中表的先后顺序就可以了。而我们在日常开发使用时，更偏向于左外连接。</p><hr /><h5 id="子查询"><a class="markdownIt-Anchor" href="#子查询"></a> 子查询</h5><ol><li><h4 id="介绍"><a class="markdownIt-Anchor" href="#介绍"></a> 介绍</h4></li></ol><p>SQL语句中嵌套select语句，称为嵌套查询，又称子查询。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  <span class="operator">*</span>  <span class="keyword">FROM</span>   t1   <span class="keyword">WHERE</span>  column1 <span class="operator">=</span>  ( <span class="keyword">SELECT</span>  column1  <span class="keyword">FROM</span>  t2 ... );</span><br></pre></td></tr></table></figure><p>子查询外部的语句可以是insert / update / delete / select 的任何一个，最常见的是 select。</p><p>根据子查询结果的不同分为：</p><ol><li>标量子查询（子查询结果为单个值 [一行一列]）</li><li>列子查询（子查询结果为一列，但可以是多行）</li><li>行子查询（子查询结果为一行，但可以是多列）</li><li>表子查询（子查询结果为多行多列[相当于子查询结果是一张表]）</li></ol><p>子查询可以书写的位置：</p><ol><li>where之后</li><li>from之后</li><li>select之后</li></ol><p>子查询的要点是，先对需求做拆分，明确具体的步骤，然后再逐条编写SQL语句。 最终将多条SQL语句合并为一条。</p><h6 id="标量子查询"><a class="markdownIt-Anchor" href="#标量子查询"></a> 标量子查询</h6><p>子查询返回的结果是单个值(数字、字符串、日期等)，最简单的形式，这种子查询称为<strong>标量子查询</strong>。</p><p>常用的操作符： =   &lt;&gt;   &gt;    &gt;=    &lt;   &lt;=</p><ul><li>案例1：查询 最早入职 的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 查询最早的入职时间</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(entry_date) <span class="keyword">from</span> emp;  <span class="comment">-- 结果: 2000-01-01</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询入职时间 = 最早入职时间的员工信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entry_date <span class="operator">=</span> <span class="string">&#x27;2000-01-01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 合并为一条SQL</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entry_date <span class="operator">=</span> (<span class="keyword">select</span> <span class="built_in">min</span>(entry_date) <span class="keyword">from</span> emp);</span><br></pre></td></tr></table></figure><ul><li>案例2：查询在 阮小五 入职之后入职的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 查询 &quot;阮小五&quot; 的入职日期</span></span><br><span class="line"><span class="keyword">select</span> entry_date <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;阮小五&#x27;</span>; <span class="comment">-- 结果: 2015-01-01</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 根据上述查询到的这个入职日期, 查询在该日期之后入职的员工信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entry_date <span class="operator">&gt;</span> <span class="string">&#x27;2015-01-01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 合并SQL为一条SQL</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entry_date <span class="operator">&gt;</span> (<span class="keyword">select</span> entry_date <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;阮小五&#x27;</span>);</span><br></pre></td></tr></table></figure><h6 id="列子查询"><a class="markdownIt-Anchor" href="#列子查询"></a> 列子查询</h6><p>子查询返回的结果是一列(可以是多行)，这种子查询称为列子查询。</p><p>常用的操作符：</p><table><thead><tr><th>操作符</th><th>描述</th></tr></thead><tbody><tr><td>in</td><td>在指定的集合范围之内，多选一</td></tr><tr><td>not in</td><td>不在指定的集合范围之内</td></tr></tbody></table><ul><li>案例1：查询 “教研部” 和 “咨询部” 的所有员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 查询 &quot;教研部&quot; 和 &quot;咨询部&quot; 的部门ID</span></span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;教研部&#x27;</span> <span class="keyword">or</span> name <span class="operator">=</span> <span class="string">&#x27;咨询部&#x27;</span>; <span class="comment">-- 结果: 3,2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 根据上面查询出来的部门ID, 查询员工信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="keyword">in</span>(<span class="number">3</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 合并SQL为一条SQL语句</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;教研部&#x27;</span> <span class="keyword">or</span> name <span class="operator">=</span> <span class="string">&#x27;咨询部&#x27;</span>);</span><br></pre></td></tr></table></figure><h6 id="行子查询"><a class="markdownIt-Anchor" href="#行子查询"></a> 行子查询</h6><p>子查询返回的结果是一行(可以是多列)，这种子查询称为行子查询。</p><p>常用的操作符：= 、&lt;&gt; 、IN 、NOT IN</p><ul><li>案例1：查询与 “李忠” 的薪资 及 职位都相同的员工信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 查询 &quot;李忠&quot; 的薪资和职位</span></span><br><span class="line"><span class="keyword">select</span> salary , job <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;李忠&#x27;</span>; <span class="comment">-- 结果: 5000, 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 根据上述查询到的薪资和职位 , 查询对应员工的信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> (salary, job) <span class="operator">=</span> (<span class="number">5000</span>,<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 将两条SQL合并为一条SQL</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> (salary, job) <span class="operator">=</span> (<span class="keyword">select</span> salary , job <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;李忠&#x27;</span>);</span><br></pre></td></tr></table></figure><h6 id="表子查询"><a class="markdownIt-Anchor" href="#表子查询"></a> 表子查询</h6><p>子查询返回的结果是多行多列，常作为临时表，这种子查询称为<strong>表子查询</strong>。</p><ul><li>案例：<em>获取每个部门中薪资最高的员工信息</em></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- a. 获取每个部门的最高薪资</span></span><br><span class="line"><span class="keyword">select</span> dept_id, <span class="built_in">max</span>(salary) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> dept_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- b. 查询每个部门中薪资最高的员工信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e , (<span class="keyword">select</span> dept_id, <span class="built_in">max</span>(salary) max_sal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> dept_id) a</span><br><span class="line">    <span class="keyword">where</span> e.dept_id <span class="operator">=</span> a.dept_id <span class="keyword">and</span> e.salary <span class="operator">=</span> a.max_sal;</span><br></pre></td></tr></table></figure><ol><li><h4 id="案例"><a class="markdownIt-Anchor" href="#案例"></a> 案例</h4></li></ol><p>根据需求，完成多表查询的SQL语句的编写。</p><ul><li>\1. 查询 “教研部” 性别为 男，且在 “2011-05-01” 之后入职的员工信息 。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">as</span> e , dept <span class="keyword">as</span> d <span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id <span class="keyword">and</span> d.name <span class="operator">=</span> <span class="string">&#x27;教研部&#x27;</span> <span class="keyword">and</span> e.gender <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> e.entry_date <span class="operator">&gt;</span> <span class="string">&#x27;2011-05-01&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li>\2. 查询工资 低于公司平均工资的 且 性别为男 的员工信息 。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">as</span> e , dept <span class="keyword">as</span> d <span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id <span class="keyword">and</span> e.salary <span class="operator">&lt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(salary) <span class="keyword">from</span> emp) <span class="keyword">and</span> e.gender <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><ul><li>\3. 查询部门人数超过 10 人的部门名称 。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> d.name , <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp <span class="keyword">as</span> e , dept <span class="keyword">as</span> d <span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id <span class="keyword">group</span> <span class="keyword">by</span> d.name <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">&gt;</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure><ul><li>\4. 查询在 “2010-05-01” 后入职，且薪资高于 10000 的 “教研部” 员工信息，并根据薪资倒序排序。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e , dept d <span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id <span class="keyword">and</span> e.entry_date <span class="operator">&gt;</span> <span class="string">&#x27;2010-05-01&#x27;</span> <span class="keyword">and</span> e.salary <span class="operator">&gt;</span> <span class="number">10000</span> <span class="keyword">and</span> d.name <span class="operator">=</span> <span class="string">&#x27;教研部&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> e.salary <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure><ul><li>\5. 查询工资 低于本部门平均工资的员工信息 。【难】</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 5.1 查询每个部门的平均工资</span></span><br><span class="line"><span class="keyword">select</span> dept_id, <span class="built_in">avg</span>(salary) avg_sal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> dept_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5.2 查询工资 低于本部门平均工资 的员工信息 。</span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span> <span class="keyword">from</span> emp e , (<span class="keyword">select</span> dept_id, <span class="built_in">avg</span>(salary) avg_sal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> dept_id) <span class="keyword">as</span> a</span><br><span class="line">          <span class="keyword">where</span> e.dept_id <span class="operator">=</span> a.dept_id <span class="keyword">and</span> e.salary <span class="operator">&lt;</span> a.avg_sal;</span><br></pre></td></tr></table></figure><hr />]]>
    </content>
    <id>https://imouyo.github.io/2026/02/11/MySQL%E5%AD%A6%E4%B9%A0/</id>
    <link href="https://imouyo.github.io/2026/02/11/MySQL%E5%AD%A6%E4%B9%A0/"/>
    <published>2026-02-11T14:27:37.000Z</published>
    <summary>
      <![CDATA[<h2 id="mysql"><a class="markdownIt-Anchor" href="#mysql"></a> MySQL</h2>
<h2 id="启动mysql服务"><a class="markdownIt-Anchor" href="#启动mysql服务">]]>
    </summary>
    <title>MySQL学习</title>
    <updated>2026-02-11T15:28:12.947Z</updated>
  </entry>
  <entry>
    <author>
      <name>John Doe</name>
    </author>
    <category term="技术" scheme="https://imouyo.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    <category term="前端" scheme="https://imouyo.github.io/categories/%E6%8A%80%E6%9C%AF/%E5%89%8D%E7%AB%AF/"/>
    <category term="java" scheme="https://imouyo.github.io/tags/java/"/>
    <id>https://imouyo.github.io/2026/02/11/demo/</id>
    <link href="https://imouyo.github.io/2026/02/11/demo/"/>
    <published>2026-02-11T10:06:19.000Z</published>
    <title>demo</title>
    <updated>2026-02-11T14:53:59.271Z</updated>
  </entry>
  <entry>
    <author>
      <name>John Doe</name>
    </author>
    <category term="技术" scheme="https://imouyo.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    <category term="前端" scheme="https://imouyo.github.io/categories/%E6%8A%80%E6%9C%AF/%E5%89%8D%E7%AB%AF/"/>
    <content>
      <![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2><h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]>
    </content>
    <id>https://imouyo.github.io/2026/02/11/hello-world/</id>
    <link href="https://imouyo.github.io/2026/02/11/hello-world/"/>
    <published>2026-02-11T03:03:04.465Z</published>
    <summary>
      <![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for]]>
    </summary>
    <title>Hello World</title>
    <updated>2026-02-11T10:14:26.403Z</updated>
  </entry>
</feed>
